(function(){var N=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};!function(e,t){"undefined"!=typeof module&&null!==module?module.exports=t():"function"==typeof define&&"object"==typeof define.amd?define(e,t):this[e]=t()}("payform",function(){var t,o,a,n,r,u,l,e,i,c,v,g,d=function(e){var t,n,r;return null!=e.selectionStart?e.selectionStart:null!=document.selection?(e.focus(),t=document.selection.createRange(),n=(r=e.createTextRange()).duplicate(),r.moveToBookmark(t.getBookmark()),n.setEndPoint("EndToStart",r),n.text.length):void 0},h=function(n){return function(e){var t;if(null==e&&(e=window.event),"insertCompositionText"!==e.inputType||e.isComposing)return t={target:e.target||e.srcElement,which:e.which||e.keyCode,type:e.type,metaKey:e.metaKey,ctrlKey:e.ctrlKey,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1}},n(t)}},f=function(e,t,n){return null!=e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},p=function(e,t,n){return null!=e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)},s={},m={UNKNOWN:0,BACKSPACE:8,PAGE_UP:33,ARROW_LEFT:37,ARROW_RIGHT:39},y=/(\d{1,4})/g;return s.cards=[{type:"elo",pattern:/^(4011(78|79)|43(1274|8935)|45(1416|7393|763(1|2))|50(4175|6699|67[0-7][0-9]|9000)|627780|63(6297|6368)|650(03([^4])|04([0-9])|05(0|1)|4(0[5-9]|3[0-9]|8[5-9]|9[0-9])|5([0-2][0-9]|3[0-8])|9([2-6][0-9]|7[0-8])|541|700|720|901)|651652|655000|655021)/,format:y,length:[16],cvcLength:[3],luhn:!0},{type:"visaelectron",pattern:/^4(026|17500|405|508|844|91[37])/,format:y,length:[16],cvcLength:[3],luhn:!0},{type:"maestro",pattern:/^(5018|5020|5038|6304|6390[0-9]{2}|67[0-9]{4})/,format:y,length:[16],cvcLength:[3],luhn:!0},{type:"forbrugsforeningen",pattern:/^600/,format:y,length:[16],cvcLength:[3],luhn:!0},{type:"dankort",pattern:/^5019/,format:y,length:[16],cvcLength:[3],luhn:!0},{type:"visa",pattern:/^4/,format:y,length:[16],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^(5[1-5][0-9]{4}|677189)|^(222[1-9]|2[3-6]\d{2}|27[0-1]\d|2720)([0-9]{2})/,format:y,length:[16],cvcLength:[3],luhn:!0},{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[4],luhn:!0},{type:"hipercard",pattern:/^(384100|384140|384160|606282|637095|637568|60(?!11))/,format:y,length:[16],cvcLength:[3],luhn:!0},{type:"dinersclub",pattern:/^(36|38|30[0-5])/,format:/(\d{1,4})(\d{1,6})?(\d{1,4})?/,length:[14],cvcLength:[3],luhn:!0},{type:"discover",pattern:/^(6011|65|64[4-9]|622)/,format:y,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^62/,format:y,length:[16],cvcLength:[3],luhn:!1},{type:"jcb",pattern:/^35/,format:y,length:[16],cvcLength:[3],luhn:!0},{type:"laser",pattern:/^(6706|6771|6709)/,format:y,length:[16],cvcLength:[3],luhn:!0}],o=function(e){var t,n,r,a;for(e=(e+"").replace(/\D/g,""),n=0,r=(a=s.cards).length;n<r;n++)if((t=a[n]).pattern.test(e))return t},a=function(e){for(var t,n=s.cards,r=0,a=n.length;r<a;r++)if((t=n[r]).type===e)return t},r=function(e){var t=getComputedStyle(e);return t&&t.direction||document.dir},l=function(e){for(var t,n=!0,r=0,a=(e+"").split("").reverse(),u=0,l=a.length;u<l;u++)t=a[u],t=parseInt(t,10),(n=!n)&&(t*=2),9<t&&(t-=9),r+=t;return r%10==0},u=function(e){var t;return!(null==("undefined"!=typeof document&&null!==document&&null!=(t=document.selection)?t.createRange:void 0)||!document.selection.createRange().text)||null!=e.selectionStart&&e.selectionStart!==e.selectionEnd},v=function(e){var t,n,r,a,u,l;for(null==e&&(e=""),l="",r=0,u=(n=e.split("")).length;r<u;r++)t=n[r],-1<(a="０１２３４５６７８９".indexOf(t))&&(t="0123456789"[a]),l+=t;return l},n={cvcInput:[{eventName:"keypress",eventHandler:h(g=function(e){var t;if(!e.metaKey&&!e.ctrlKey&&!(-1<[m.UNKNOWN,m.ARROW_LEFT,m.ARROW_RIGHT].indexOf(e.which)||e.which<m.PAGE_UP))return t=String.fromCharCode(e.which),/^\d+$/.test(t)?void 0:e.preventDefault()})},{eventName:"keypress",eventHandler:h(function(e){var t=String.fromCharCode(e.which);if(/^\d+$/.test(t)&&!u(e.target))return 4<(e.target.value+t).length?e.preventDefault():void 0})},{eventName:"paste",eventHandler:h(e=function(e){var t;if(""!==e.target.value)return t=d(e.target),e.target.value=v(e.target.value).replace(/\D/g,"").slice(0,4),null!=t&&"change"!==e.type?e.target.setSelectionRange(t,t):void 0})},{eventName:"change",eventHandler:h(e)},{eventName:"input",eventHandler:h(e)}],expiryInput:[{eventName:"keypress",eventHandler:h(g)},{eventName:"keypress",eventHandler:h(function(e){var t=String.fromCharCode(e.which);if(/^\d+$/.test(t)&&!u(e.target))return 6<(e.target.value+t).replace(/\D/g,"").length?e.preventDefault():void 0})},{eventName:"keypress",eventHandler:h(function(e){var t,n=String.fromCharCode(e.which);if(/^\d+$/.test(n))return t=e.target.value+n,/^\d$/.test(t)&&"0"!==t&&"1"!==t?(e.preventDefault(),setTimeout(function(){return e.target.value="0"+t+" / "})):/^\d\d$/.test(t)?(e.preventDefault(),setTimeout(function(){return e.target.value=t+" / "})):void 0})},{eventName:"keypress",eventHandler:h(function(e){var t,n=String.fromCharCode(e.which);if("/"===n||" "===n)return t=e.target.value,/^\d$/.test(t)&&"0"!==t?e.target.value="0"+t+" / ":void 0})},{eventName:"keypress",eventHandler:h(function(e){var t,n=String.fromCharCode(e.which);if(/^\d+$/.test(n))return t=e.target.value,/^\d\d$/.test(t)?e.target.value=t+" / ":void 0})},{eventName:"keydown",eventHandler:h(function(e){var t,n=e.target.value;if(e.which===m.BACKSPACE&&(!(t=d(e.target))||t===n.length))return/\d\s\/\s$/.test(n)?(e.preventDefault(),setTimeout(function(){return e.target.value=n.replace(/\d\s\/\s$/,"")})):void 0})},{eventName:"change",eventHandler:h(c=function(e){var t;if(""!==e.target.value)return e.target.value=s.formatCardExpiry(e.target.value),"rtl"===r(e.target)&&-1===e.target.value.indexOf("‎‎")&&(e.target.value="‎‎".concat(e.target.value)),null!=(t=d(e.target))&&"change"!==e.type?e.target.setSelectionRange(t,t):void 0})},{eventName:"input",eventHandler:h(c)}],cardNumberInput:[{eventName:"keypress",eventHandler:h(g)},{eventName:"keypress",eventHandler:h(function(e){var t,n,r,a=String.fromCharCode(e.which);if(/^\d+$/.test(a)&&!u(e.target))return r=(e.target.value+a).replace(/\D/g,""),n=(t=o(r))?t.length[t.length.length-1]:16,r.length>n?e.preventDefault():void 0})},{eventName:"keypress",eventHandler:h(function(e){var t,n,r,a,u,l,i=String.fromCharCode(e.which);if(/^\d+$/.test(i)&&(l=e.target.value,t=o(l+i),r=(l.replace(/\D/g,"")+i).length,u=16,t&&(u=t.length[t.length.length-1]),!(u<=r||(n=d(e.target))&&n!==l.length)))return(a=t&&"amex"===t.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/).test(l)?(e.preventDefault(),setTimeout(function(){return e.target.value=l+" "+i})):a.test(l+i)?(e.preventDefault(),setTimeout(function(){return e.target.value=l+i+" "})):void 0})},{eventName:"keydown",eventHandler:h(function(e){var t,n=e.target.value;if(e.which===m.BACKSPACE&&!((t=d(e.target))&&t!==n.length||1<e.target.selectionEnd-e.target.selectionStart))return/\d\s$/.test(n)?(e.preventDefault(),setTimeout(function(){return e.target.value=n.replace(/\d\s$/,"")})):/\s\d?$/.test(n)?(e.preventDefault(),setTimeout(function(){return e.target.value=n.replace(/\d$/,"")})):void 0})},{eventName:"paste",eventHandler:h(i=function(e){var t=d(e.target);if(""!==e.target.value)return"ltr"===r(e.target)&&(t=d(e.target)),e.target.value=s.formatCardNumber(e.target.value),"ltr"===r(e.target)&&t!==e.target.selectionStart&&(t=d(e.target)),"rtl"===r(e.target)&&-1===e.target.value.indexOf("‎‎")&&(e.target.value="‎‎".concat(e.target.value)),null!=(t=d(e.target))&&0!==t&&"change"!==e.type?e.target.setSelectionRange(t,t):void 0})},{eventName:"change",eventHandler:h(i)},{eventName:"input",eventHandler:h(i)}],numericInput:[{eventName:"keypress",eventHandler:h(g)},{eventName:"paste",eventHandler:h(g)},{eventName:"change",eventHandler:h(g)},{eventName:"input",eventHandler:h(g)}]},t=function(e,t,n){for(var r,a=0,u=t.length;a<u;a++)r=t[a],(n?p:f)(e,r.eventName,r.eventHandler)},s.cvcInput=function(e){return t(e,n.cvcInput)},s.expiryInput=function(e){return t(e,n.expiryInput)},s.cardNumberInput=function(e){return t(e,n.cardNumberInput)},s.numericInput=function(e){return t(e,n.numericInput)},s.detachCvcInput=function(e){return t(e,n.cvcInput,!0)},s.detachExpiryInput=function(e){return t(e,n.expiryInput,!0)},s.detachCardNumberInput=function(e){return t(e,n.cardNumberInput,!0)},s.detachNumericInput=function(e){return t(e,n.numericInput,!0)},s.parseCardExpiry=function(e){var t,n,r=(t=(e=e.replace(/\s/g,"")).split("/",2))[0];return 2===(null!=(n=t[1])?n.length:void 0)&&/^\d+$/.test(n)&&(n=(new Date).getFullYear().toString().slice(0,2)+n),{month:r=parseInt(r.replace(/[\u200e]/g,""),10),year:n=parseInt(n,10)}},s.validateCardNumber=function(e){var t,n;return e=(e+"").replace(/\s+|-/g,""),!!/^\d+$/.test(e)&&(!!(t=o(e))&&(n=e.length,0<=N.call(t.length,n)&&(!1===t.luhn||l(e))))},s.validateCardExpiry=function(e,t){var n,r,a;return"object"==typeof e&&"month"in e&&(e=(a=e).month,t=a.year),!(!e||!t)&&(e=String(e).trim(),t=String(t).trim(),!!/^\d+$/.test(e)&&(!!/^\d+$/.test(t)&&(1<=e&&e<=12&&(2===t.length&&(t=t<70?"20"+t:"19"+t),4===t.length&&(r=new Date(t,e),n=new Date,r.setMonth(r.getMonth()-1),r.setMonth(r.getMonth()+1,1),n<r)))))},s.validateCardCVC=function(e,t){var n,r;return e=String(e).trim(),!!/^\d+$/.test(e)&&(n=a(t),console.log("focsu: ",n),null!=n?(r=e.length,0<=N.call(n.cvcLength,r)):3<=e.length&&e.length<=4)},s.parseCardType=function(e){var t;return e&&(null!=(t=o(e))?t.type:void 0)||null},s.formatCardNumber=function(e){var t,n,r,a;return e=(e=v(e)).replace(/\D/g,""),(t=o(e))?(a=t.length[t.length.length-1],e=e.slice(0,a),t.format.global?null!=(r=e.match(t.format))?r.join(" "):void 0:null!=(n=t.format.exec(e))?(n.shift(),(n=n.filter(Boolean)).join(" ")):void 0):e},s.formatCardExpiry=function(e){var t,n,r,a;return(n=(e=v(e)).match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/))?(t=n[1]||"",r=n[2]||"",0<(a=n[3]||"").length?r=" / ":" /"===r?(t=t.substring(0,1),r=""):2===t.length||0<r.length?r=" / ":1===t.length&&"0"!==t&&"1"!==t&&(t="0"+t,r=" / "),t+r+a):""},s})}).call(this);